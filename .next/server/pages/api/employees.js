"use strict";(()=>{var e={};e.id=175,e.ids=[175],e.modules={6860:e=>{e.exports=require("express")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5900:e=>{e.exports=require("pg")},5616:e=>{e.exports=import("next-connect")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},6769:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>i,default:()=>c,routeModule:()=>y});var o=r(1802),a=r(7153),n=r(6249),l=r(5265),u=e([l]);l=(u.then?(await u)():u)[0];let c=(0,n.l)(l,"default"),i=(0,n.l)(l,"config"),y=new o.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/employees",pathname:"/api/employees",bundlePath:"",filename:""},userland:l});s()}catch(e){s(e)}})},9737:(e,t,r)=>{let{Pool:s}=r(5900),o=new s({connectionString:process.env.DATABASE_URL});console.error("Using database:",process.env.DATABASE_URL),o.query("SELECT NOW()",(e,t)=>{e?console.error("Error connecting to database:",e):(console.log("Connected to database successfully"),console.log("Current timestamp:",t.rows[0].now))}),e.exports=o},4336:(e,t,r)=>{r(6860);let s=r(3265),o=async(e,t)=>{try{let r=await s.createEmployee(e.body);if(!r)throw Error("Failed to create employee");t.status(201).json(r)}catch(e){t.status(500).json({error:e.message||"Internal server error"})}},a=async(e,t)=>{try{let e=await s.getAllEmployees();t.status(200).json(e)}catch(e){t.status(500).json({error:e.message})}},n=async(e,t,r)=>{try{let e=await s.getEmployeeById(r);if(!e)return t.status(404).json({error:"Employee not found"});t.status(200).json(e)}catch(e){t.status(500).json({error:e.message})}},l=async(e,t,r,o)=>{try{let e=await s.updateEmployee(r,e);if(!e)return t.status(404).json({error:"Employee not found"});t.status(200).json(e)}catch(e){t.status(500).json({error:e.message})}},u=async(e,t,r)=>{try{let e=await s.deleteEmployee(r);if(!e)return t.status(404).json({error:"Employee not found"});return t.status(200).json(e)}catch(e){t.status(500).json({error:e.message})}};e.exports={createEmployee:o,getAllEmployees:a,getEmployeeById:n,updateEmployee:l,deleteEmployee:u}},3265:(e,t,r)=>{let s=r(9737),o=async e=>{let{name:t,email:r,phone:o}=e;return(await s.query("INSERT INTO employees (name, email, phone) VALUES ($1, $2, $3) RETURNING *",[t,r,o])).rows[0]},a=async()=>(await s.query("SELECT * FROM employees")).rows,n=async e=>(await s.query("SELECT * FROM employees WHERE id = $1",[e])).rows[0],l=async(e,t)=>{let{name:r,email:o,phone:a}=t;return(await s.query("UPDATE employees SET name = $1, email = $2, phone = $3 WHERE id = $4 RETURNING *",[r,o,a,e])).rows[0]},u=async e=>(await s.query("DELETE FROM employees WHERE id = $1 RETURNING *",[e])).rows[0];e.exports={createEmployee:o,getAllEmployees:a,getEmployeeById:n,updateEmployee:l,deleteEmployee:u}},5265:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>u});var o=r(5616),a=r(4336),n=e([o]);o=(n.then?(await n)():n)[0];let l=(0,o.default)();l.get(async(e,t)=>{try{let r=await (0,a.getAllEmployees)(e,t);t.status(200).json(r)}catch(e){t.status(500).json({error:e.message})}}),l.post(async(e,t)=>{try{let r=e.body;console.log("input:",r);let s=await (0,a.createEmployee)(e,t);console.log("returned:",s.body),t.status(201).json(s)}catch(e){t.status(500).json({error:e.message})}});let u=l;s()}catch(e){s(e)}})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=6769);module.exports=r})();